Dockerfile
==========

--> A Dockerfile is a text document containing a series of instructions on how to build a Docker image. It defines everything needed to create 
a containerized application, including the base image, the application code, and any necessary dependencies.

--> Docker runs these instructions from top to bottom 

--> These includes instructions like FROM,COPY, ADD, RUN, CMD, ENTRYPOINT, ARG, ENV, WORKDIR, EXPOSE, VOLUME, etc...

--> Instructions are not a case-sensitive , But use uppecase for better redability.

--> Default name of docker file is "Dockerfile"

Example:

FROM tomcat:9.0.100
COPY target/maven-web-application.war /usr/local/tomcat/webapps/maven-web-application.war
RUN echo "hello kk funda"



1. Base Image
-------------


FROM <image>:<tag>

--> Specifies the base image to use for the Docker image. 
--> This is the starting point from which your image is built. 
--> Common base images include official images for operating systems like Ubuntu or Alpine, or language-specific images like java or Node.js.



Example: FROM ubuntu:20.04



2. Maintainer (Optional)
------------------------


MAINTAINER <name> <email>

--> Provides information about the maintainer of the image. 
--> This instruction is now deprecated in favor of using LABEL, but it's still sometimes used in older Dockerfiles.


Example: MAINTAINER KK EDUCATION <kkeducationblr@gmail.com




3. Labels (Metadata)
---------------------

LABEL <key>=<value> ...

Purpose: Adds metadata to the image in the form of key-value pairs. This can include information about the version, description, 
or any custom information you want to include.


Examples: 

LABEL version="1.0" description="A sample image"

LABEL company="KK EDUCATION"
LABEL mail="kkeducationblr@gmail.com"

NOTE: More than one LABEL will allow in image




4. Copy Files
-------------

COPY <src> <dest>

Purpose: Copies files or directories from the host machine to the image. The source path is relative to the build context 
(the directory containing the Dockerfile), and the destination path is inside the image.

Example: COPY target/mavan-web-application.war /usr/local/tomcat/webapps/maven-web-application.war

         COPY . .
    
        COPY abc.tar /opt/


5. Add Files
------------

ADD <src> <dest>

Purpose: Similar to COPY, but with additional features like handling remote URLs and automatically extracting tar archives.


Example: ADD https://example.com/file.tar.gz /app/

         ADD abc.tar /opt/    -> untar 



6. RUN 
------
--> RUN instruction used to execute a commands/ scripts etc.
--> RUN instruction will be executed while creating an image. ************
--> This instruction will be executed based on based image.
--> It can be executed in a two ways 1. shell form and 2. executable form.

use cases: 1. creating a directory
           2. execute a software
           3. unzip any zip file etc..
EX:
   shell form
   ----------
   RUN mkdir -p /opt/app
   RUN tar -xvzf /opt/apache-tomcat.tar.gz
   RUN useradd kkfunda
   RUN apt-get update && apt-get install git wget -y
   RUN ./setup.sh



   executable form
   ---------------
   RUN ["apt-get", "install", "-y", "vim"]
   RUN ["/bin/sh", "setup.sh"]
   RUN ["useradd","kkfunda"]

NOTE: please use shell form for ONLY RUN instructions, so we can replace variables easily.




7. CMD
------
--> CMD instruction used to execute a commands/ scripts etc.
--> CMD instruction will be executed while creating a container. ****
--> This instruction will be executed based on based image.



****

---> yappudu ithy manam just docker run onecon ani container create cheystamo appudu matharame kinda hello java ani vasthundi

---> but docker run -d -p 80:80 --name ubuntucon ubuntuimage ani container create cheystamo appudu matharam hello java radu bcz -d means detached mode 
lo run avthundi

---> status check cheyali ante appudu use this command ----docker inspect <container-name or ID> --format '{{.Config.Cmd}}'--- it help us to show u kinda 
hello java ani vasthudni

***



CMD echo "Hello java"

for example:-- docker run -d -p 8080:9000 --name sonarcon sonarqube:0.0.1

from down it will show u Hello java (which u mentioned in Dockerfile CMD echo "Hello java")

if u not mention CMD echo "Hello java", it will take default conatinerID will show u

* docker run sonarimage:0.0.1--------->another method to run the container 

* Here im not given container name(--name sonarcon) but it will take default like busy_joliot

* And if u observe here in COMMAND col echo"hello java " is their or else it will display while docker run -d -p 8080:8080 --name sonarcon sonaqube then will

 display down hello java

ubuntu@ip-172-31-12-23:~/dockerfiles$ docker run --name con2 two:latest
----------
hello java |
----------
ubuntu@ip-172-31-12-23:~/dockerfiles$


ubuntu@ip-172-31-12-23:~/dockerfiles$ docker ps -a
CONTAINER ID   IMAGE        COMMAND                  CREATED              STATUS                     PORTS   NAMES
ef8473b114c1   two:latest   "/bin/sh -c 'echo \"hâ€¦"  15 seconds ago       Exited (0) 15 seconds ago          busy_joliot
7503aabc7le7   two:latest   "/bin/sh -c 'echo \"hâ€¦"  About a minute ago   Exited (0) About a minute ago      con2
ubuntu@ip-172-31-12-23:~/dockerfiles$



1. When u build image for Dockerfile it will execute from top to bottom is shows u like this created container and removed container, then if u add another 
CMD instruction in last line then build the image it will shows 1 to 6 lines are using cache to build images and last line means 7 line it will create and
removed the container.

2. In Dockerfile if u add line 4 CMD echo "hello python" then build the image it will displays u 1 2 3 lines using cache and 4 5 6 7 lines created container 
and removed container. So that u need to be give CMD instruction in last line only

3. In Dockerfile CMD echo "hello Python" then if u create a container it will not give u hello python bcz u need to be first build the images and then 
run container. And if u observe here CMD instruction will execute the recent instrcution from hello java to hello python.

4.In Dockerfile having single line CMD echo "hello java" in last line then create a container like this 

docker run -d -p 8080:9000 --name sonarcon sonarqube:0.0.1 date   by adding date instead of not only date we can give pwd, uname, ls -lrth and any linux commands

it will shows u so that it will override

ubuntu@ip-172-31-12-23:~/dockerfiles$ docker run -d -p 8080:9000 --name sonarcon sonarqube:0.0.1 date
Thu Oct 23 14:26:26 UTC 2025
ubuntu@ip-172-31-12-23:~/dockerfiles$

5. If u want u show the container layer then "docker inspect <container-id>"


For CMD example--
=================
   shell form
   ----------
   CMD sh app.sh
   CMD java -jar abc.jar

   executable form
   ---------------
   CMD ["sh", "app.sh"]
   CMD ["java", "-jar", "abc.jar"]

NOTE: please use shell form for ONLY CMD instructions, so we can replace variables easily.


         ----(OR)-----

---> RUN instruction will be executed while building the image.

---> CMD instruction is used to provide default commands or scripts that run when the container starts.

---> ENTRYPOINT instruction is used to specify the main command or script that will always run when the container starts.


         ------(OR)------

ðŸ” Quick Note
--------------

RUN â†’ during image build.

CMD â†’ at container start, can be overridden.

ENTRYPOINT â†’ at container start, is not overridden easily.




IQ] what is shell form and executable form in docker?    ----(DOUBT UNDI)----

ANS:  RUN, CMD, ENTRYPOINT instructions can be defined in a shell form or executable form.

--> When we use shell form our command will be running as a "child process" under bash/sh (Shell)

  EX:  RUN java -jar app.jar

     --> In background above command will be executed as below
         
         /bin/sh -c java -jar app.jar
   [parent process]   [child process]

   NOTE: if you kill the parent process , It will not kill child process because some times child process connected to DB.

   EX: RUN ["java", "-jar", "app.jar"]

     --> In background above command will be executed as below
      
         /bin/java -jar app.jar
         [parent process]

NOTE: when you are using CMD and ENTRYPOINT executable form is preferable.




IQ] what is the difference between RUN and CMD?

ANS:
  --> RUN instruction will be executed while creating an image.
  --> CMD instruction will be executed while creating a container.
  --> we have more than one RUN instruction in a Dockerfile. All the RUN instructions will be executed, while creating an image in the defined order 
         (top to bottom).

RUN sh abc.sh
RUN echo "kkfunda"

CMD echo "one"
CMD echo "two"
CMD echo "three"

IQ] can you have a more than one CMD in a Dockerfile?
 Ans: Yes you have, But only the last one/ recent one in the order will be executed while creating a container.
      here recent means three




8. ENTRYPOINT----This is discuss and continue in DAY-06 class plz check their
----------------------------------------------------------------------------
